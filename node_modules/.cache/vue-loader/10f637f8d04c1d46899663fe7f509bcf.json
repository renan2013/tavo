{"remainingRequest":"C:\\Users\\Renan Galvan\\Desktop\\proyectos_git_lab\\TAVOCR\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Renan Galvan\\Desktop\\proyectos_git_lab\\TAVOCR\\src\\views\\apps\\chat\\Chat.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Renan Galvan\\Desktop\\proyectos_git_lab\\TAVOCR\\src\\views\\apps\\chat\\Chat.vue","mtime":1603840912323},{"path":"C:\\Users\\Renan Galvan\\Desktop\\proyectos_git_lab\\TAVOCR\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Renan Galvan\\Desktop\\proyectos_git_lab\\TAVOCR\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Renan Galvan\\Desktop\\proyectos_git_lab\\TAVOCR\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Renan Galvan\\Desktop\\proyectos_git_lab\\TAVOCR\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Vue from \"vue\";\nimport { mapActions } from \"vuex\";\n\nimport ChatContact from \"./ChatContact.vue\";\nimport ChatLog from \"./ChatLog.vue\";\nimport ChatNavbar from \"./ChatNavbar.vue\";\nimport UserProfile from \"./UserProfile.vue\";\nimport VuePerfectScrollbar from \"vue-perfect-scrollbar\";\nimport moduleChat from \"@/store/chat/moduleChat.js\";\nimport * as divilib from \"@/divisoftlibs/utilDivisoftJS.js\";\n\n//import io from 'socket.io-client';\nexport default {\n  created() {\n    // this.$store.commit('chat/MUTSETCURRENTCONTACT',5);\n    this.contactId = this.$route.params.contactId;\n    this.$store.commit(\"chat/MUTSETCURRENTCONTACT\", 0);\n\n    let vm = this;\n    setTimeout(function (store) {\n      vm.$store.commit(\"chat/MUTSETCURRENTCONTACT\", vm.contactId);\n    }, 2000);\n\n    let datos = {\n      NumEmpresa: this.getProfile[0].Empresa,\n      userid: this.getProfile[0].num_user,\n    };\n    // contactos\n    this.getfetContacts(datos);\n    this.getChatContacts(datos);\n    this.setSidebarWidth();\n  },\n\n  mounted() {\n    try {\n      this.$socket.connect();\n      this.$store.commit(\n        \"chat/MUTCHATCONNECT\",\n        \"No Conectado sus Mensajes No seran Entregados\"\n      );\n\n      const payload = {\n        NumEmpresa: this.getProfile[0].Empresa,\n        username: this.getProfile[0].Username,\n        id: this.getProfile[0].num_user,\n        msg: this.mensajeConectado,\n      };\n\n      this.$socket.emit(\"TEST_CONNECTION\", payload, function (response) {\n        console.log(\"se disparo el   collback de Conectado \", response);\n      });\n    } catch (error) {\n      console.log(\"en Chat.vue  en mounted catch\" + error);\n    }\n    this.typedMessage = \"\";\n  },\n\n  data() {\n    return {\n      tokenChat: \"\",\n      colorConectado: \"text-danger\",\n      mensajeConectado: \"Listo* Puede Chatear\",\n      contactId: \"0\",\n\n      chatMsg: {\n        msg: 1,\n      },\n      messages: [],\n      active: true,\n      isHidden: false,\n      searchContact: \"\",\n      activeProfileSidebar: false,\n      activeChatUser: 118,\n      userProfileId: -1,\n      typedMessage: \"\",\n      isChatPinned: false,\n      settings: {\n        maxScrollbarLength: 60,\n        wheelSpeed: 0.7,\n      },\n      clickNotClose: true,\n      isChatSidebarActive: true,\n      isLoggedInUserProfileView: false,\n    };\n  },\n  watch: {\n    getChatconnect() {\n      if (this.getChatconnect == this.mensajeConectado)\n        this.colorConectado = \"text-success\";\n    },\n    chatMsg() {\n      console.log(\"mensaje\", this.chatMsg);\n      this.setMessage(this.chatMsg);\n    },\n\n    windowWidth() {\n      this.setSidebarWidth();\n    },\n    getProfile() {\n      console.log(\"cambio el profile CHAT LINEA 167 APROX\");\n      //  alert(\"profile cambio \");\n    },\n    getCurrentContact() {\n      if (this.getCurrentContact > 0) {\n        let usuariochat = this.getCurrentContact;\n        try {\n          usuariochat = parseInt(usuariochat, 10);\n        } catch (error) {}\n\n        this.updateActiveChatUser(usuariochat);\n      }\n\n      //  alert(\"profile cambio \");\n    },\n  },\n  computed: {\n    getChatconnect() {\n      return this.$store.state.chat.chatconnect;\n    },\n    getRecargar() {\n      return this.$store.state.recargar;\n    },\n    getCurrentContact() {\n      return this.$store.state.chat.currentContact;\n    },\n\n    getAppActiveUser() {\n      return this.$store.state.AppActiveUser;\n    },\n    getchats() {\n      return this.$store.state.chat.chats;\n    },\n    getProfile() {\n      return this.$store.state.dsoaLogin.profile;\n    },\n    // COMPONENTE DIVISOFT CHAT\n    getTokenChat() {\n      return this.$store.state.dsoaLogin.token;\n    },\n\n    chatLastMessaged() {\n      return (userId) => this.$store.getters[\"chat/chatLastMessaged\"](userId);\n    },\n    chatUnseenMessages() {\n      return (userId) => {\n        const unseenMsg = this.$store.getters[\"chat/chatUnseenMessages\"](\n          userId\n        );\n        if (unseenMsg) return unseenMsg;\n      };\n    },\n    activeUser() {\n      return this.$store.state.AppActiveUser;\n    },\n    getStatusColor() {\n      return (isActiveUser) => {\n        const userStatus = this.getUserStatus(isActiveUser);\n\n        if (userStatus === \"online\") {\n          return \"success\";\n        } else if (userStatus === \"do not disturb\") {\n          return \"danger\";\n        } else if (userStatus === \"away\") {\n          return \"warning\";\n        } else {\n          return \"grey\";\n        }\n      };\n    },\n    chatContacts() {\n      return this.$store.getters[\"chat/chatContacts\"];\n    },\n    contacts() {\n      return this.$store.getters[\"chat/contacts\"];\n    },\n\n    searchQuery: {\n      get() {\n        if (this.$store.state.chat.chatSearchQuery)\n          return this.$store.state.chat.chatSearchQuery;\n        else return \"\";\n      },\n      set(val) {\n        this.$store.dispatch(\"chat/setChatSearchQuery\", val);\n      },\n    },\n    scrollbarTag() {\n      return this.$store.getters.scrollbarTag;\n    },\n    isActiveChatUser() {\n      return (userId) => userId === this.activeChatUser;\n    },\n    windowWidth() {\n      return this.$store.state.windowWidth;\n    },\n  },\n  methods: {\n    recarga() {\n      this.$router.go(this.$router.currentRoute);\n    },\n    getUserStatus(isActiveUser) {\n      // return \"active\"\n      return isActiveUser\n        ? this.$store.state.AppActiveUser.status\n        : this.contacts[this.activeChatUser].status;\n    },\n    closeProfileSidebar(value) {\n      this.activeProfileSidebar = value;\n    },\n\n    updateActiveChatUser(contactId) {\n      //  this.$store.commit('chat/MUTSETCURRENTCONTACT',5);\n      this.contactId = 0;\n\n      try {\n        this.activeChatUser = parseInt(contactId, 10);\n      } catch (error) {\n        this.activeChatUser = contactId;\n      }\n\n      let datos = {\n        NumEmpresa: this.getProfile[0].Empresa,\n        userid: this.getProfile[0].num_user,\n        userSend: contactId,\n      };\n\n      this.getfetChats(datos);\n\n      if (this.$store.getters[\"chat/chatDataOfUser\"](this.activeChatUser)) {\n        this.$store.dispatch(\"chat/markSeenAllMessages\", contactId);\n      }\n      const chatData = this.$store.getters[\"chat/chatDataOfUser\"](\n        this.activeChatUser\n      );\n      if (chatData) this.isChatPinned = chatData.isPinned;\n      else this.isChatPinned = false;\n      this.toggleChatSidebar();\n      this.typedMessage = \"\";\n    },\n    showProfileSidebar(userId, openOnLeft = false) {\n      try {\n        this.userProfileId = parseInt(userId, 10);\n      } catch (error) {\n        this.userProfileId = userId;\n      }\n\n      this.isLoggedInUserProfileView = openOnLeft;\n      this.activeProfileSidebar = !this.activeProfileSidebar;\n    },\n\n    sendMsg() {\n      //alert(\"divisoft envieando MENSAJE\");\n      if (!this.typedMessage) return;\n      if (!this.activeChatUser) return;\n\n      const payload = {\n        NumEmpresa: this.getProfile[0].Empresa,\n        isPinned: this.isChatPinned,\n        username: this.getProfile[0].Username,\n        sendusernum: this.getProfile[0].num_user,\n\n        msg: {\n          textContent: this.typedMessage,\n          time: String(new Date()),\n          isSent: true,\n          isSeen: false,\n        },\n        id: this.activeChatUser,\n      };\n      //ADEMAR VER SI HAY COMUNICACION\n      console.log(\"enviando \", JSON.stringify(payload));\n\n      this.typedMessage = \"\";\n\n      // se lo manda al destinatrio\n\n      this.$socket.emit(\"SEND_MESSAGE\", payload, function (response) {\n        console.log(\"se disparo el  collback\", response);\n      });\n      // lo refresca en nuestro chat\n\n      this.$store.dispatch(\"chat/SENDCHATMESSAGE\", payload);\n\n      const scroll_el = this.$refs.chatLogPS.$el || this.$refs.chatLogPS;\n      scroll_el.scrollTop = this.$refs.chatLog.scrollHeight;\n    },\n\n    setMessage(data) {\n      this.$store.commit(\"chat/SEND_CHAT_MESSAGE\", data);\n    },\n\n    toggleIsChatPinned(value) {\n      this.isChatPinned = value;\n    },\n    setSidebarWidth() {\n      if (this.windowWidth < 1200) {\n        this.isChatSidebarActive = this.clickNotClose = false;\n      } else {\n        this.isChatSidebarActive = this.clickNotClose = true;\n      }\n    },\n    toggleChatSidebar(value = false) {\n      if (!value && this.clickNotClose) return;\n      this.isChatSidebarActive = value;\n    },\n\n    getfetContacts(datos) {\n      this.$store.dispatch(\"chat/fetchContacts\", datos);\n      return 1;\n    },\n\n    getfetChats(datos) {\n      this.$store.dispatch(\"chat/fetchChats\", datos);\n      return 1;\n    },\n    getChatContacts(datos) {\n      this.$store.dispatch(\"chat/fetchChatContacts\", datos);\n      return 1;\n    },\n  },\n  components: {\n    VuePerfectScrollbar,\n    ChatContact,\n    UserProfile,\n    ChatNavbar,\n    ChatLog,\n  },\n\n  /* beforeDestroy() {\n         this.$store.unregisterModule('chat')\n     }*/\n};\n",{"version":3,"sources":["Chat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyMA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Chat.vue","sourceRoot":"src/views/apps/chat","sourcesContent":["<!-- =========================================================================================\n    File Name: Chat.vue\n    Description: Chat Application - Stay connected\n    ----------------------------------------------------------------------------------------\n    Item Name: Vuexy - Vuejs, HTML & Laravel Admin Dashboard Template\n      Author: Pixinvent\n    Author URL: http://www.themeforest.net/user/pixinvent\n========================================================================================== -->\n\n<template>\n  <!-- USER PROFILE SIDEBAR -->\n\n  <div\n    v-if=\"getTokenChat\"\n    id=\"chat-app\"\n    class=\"border border-solid d-theme-border-grey-light rounded relative overflow-hidden\"\n  >\n    <!-- TOKEN CHAT:{{getTokenChat}}-->\n\n    <vs-sidebar\n      class=\"items-no-padding\"\n      parent=\"#chat-app\"\n      :click-not-close=\"clickNotClose\"\n      :hidden-background=\"clickNotClose\"\n      v-model=\"isChatSidebarActive\"\n      id=\"chat-list-sidebar\"\n    >\n      <user-profile\n        :active=\"activeProfileSidebar\"\n        :userId=\"userProfileId\"\n        class=\"user-profile-container\"\n        :isLoggedInUser=\"isLoggedInUserProfileView\"\n        @closeProfileSidebar=\"closeProfileSidebar\"\n      ></user-profile>\n\n      <div class=\"chat__profile-search flex p-4\">\n        <div class=\"relative inline-flex\">\n          <!--vs-avatar v-if=\"activeUser.photoURL\" class=\"m-0 border-2 border-solid border-white\" :src=\"activeUser.photoURL\" size=\"40px\" @click=\"showProfileSidebar(Number(activeUser.uid), true)\" /-->\n          <div\n            class=\"h-3 w-3 border-white border border-solid rounded-full absolute right-0 bottom-0\"\n            :class=\"'bg-' + getStatusColor(true)\"\n          ></div>\n        </div>\n        <vs-input\n          icon-no-border\n          icon=\"icon-search\"\n          icon-pack=\"feather\"\n          class=\"w-full mx-5 input-rounded-full\"\n          placeholder=\"Search or start a new chat\"\n          v-model=\"searchQuery\"\n        />\n\n        <feather-icon\n          class=\"md:inline-flex lg:hidden -ml-3 cursor-pointer\"\n          icon=\"XIcon\"\n          @click=\"toggleChatSidebar(false)\"\n        />\n      </div>\n\n      <vs-divider class=\"d-theme-border-grey-light m-0\" />\n\n      <component\n        :is=\"scrollbarTag\"\n        class=\"chat-scroll-area pt-4\"\n        :settings=\"settings\"\n        :key=\"$vs.rtl\"\n      >\n        <!-- ACTIVE CHATS LIST\n            TOKEN CHAT:{{getTokenChat}} -->\n\n        <p :class=\"colorConectado\">Estado del chat: {{ getChatconnect }}</p>\n\n        <div class=\"chat__chats-list mb-8\">\n          <h3 class=\"text-primary mb-5 px-4\">Chats Principal</h3>\n          <ul class=\"chat__active-chats bordered-items\">\n            <li\n              class=\"cursor-pointer\"\n              v-for=\"(contact, index) in chatContacts\"\n              :key=\"index\"\n              @click=\"updateActiveChatUser(contact.uid)\"\n            >\n              <chat-contact\n                v-if=\"chatLastMessaged\"\n                showLastMsg\n                :contact=\"contact\"\n                :lastMessaged=\"chatLastMessaged(contact.uid).time\"\n                :unseenMsg=\"chatUnseenMessages(contact.uid)\"\n                :isActiveChatUser=\"isActiveChatUser(contact.uid)\"\n              ></chat-contact>\n            </li>\n          </ul>\n        </div>\n\n        <!-- CONTACTS LIST \n        CONTACTS LIST CHAT.VUE-->\n        <div class=\"chat__contacts\">\n          <h3 class=\"text-primary mb-5 px-4\">Contactos</h3>\n          <ul class=\"chat__contacts bordered-items\">\n            <li\n              class=\"cursor-pointer\"\n              v-for=\"contact in contacts\"\n              :key=\"contact.uid\"\n              @click=\"updateActiveChatUser(contact.uid)\"\n            >\n              <chat-contact :contact=\"contact\"> </chat-contact>\n            </li>\n          </ul>\n        </div>\n      </component>\n    </vs-sidebar>\n\n    <!-- RIGHT COLUMN \n    RIGHT COLUMN CHAT.VUE-->\n    <div\n      class=\"chat__bg no-scroll-content chat-content-area border border-solid d-theme-border-grey-light border-t-0 border-r-0 border-b-0\"\n      :class=\"{\n        'sidebar-spacer--wide': clickNotClose,\n        'flex items-center justify-center': activeChatUser === null,\n      }\"\n    >\n      <template v-if=\"activeChatUser\">\n        <div class=\"chat__navbar\">\n          <chat-navbar\n            :isSidebarCollapsed=\"!clickNotClose\"\n            :user-id=\"activeChatUser\"\n            :isPinnedProp=\"isChatPinned\"\n            @openContactsSidebar=\"toggleChatSidebar(true)\"\n            @showProfileSidebar=\"showProfileSidebar\"\n            @toggleIsChatPinned=\"toggleIsChatPinned\"\n          ></chat-navbar>\n        </div>\n\n        <component\n          :is=\"scrollbarTag\"\n          class=\"chat-content-scroll-area border border-solid d-theme-border-grey-light\"\n          :settings=\"settings\"\n          ref=\"chatLogPS\"\n          :key=\"$vs.rtl\"\n        >\n          <div class=\"chat__log\" ref=\"chatLog\">\n            <chat-log :userId=\"activeChatUser\" v-if=\"activeChatUser\"></chat-log>\n          </div>\n        </component>\n\n        <div class=\"chat__input flex p-4 bg-white\">\n          <vs-input\n            class=\"flex-1\"\n            placeholder=\"Su Mensaje aqui\"\n            v-model=\"typedMessage\"\n            @keyup.enter=\"sendMsg\"\n          />\n\n          <vs-button\n            class=\"bg-primary-gradient ml-4\"\n            type=\"filled\"\n            @click=\"sendMsg\"\n            >Send</vs-button\n          >\n        </div>\n      </template>\n\n      <template v-else>\n        <div class=\"flex flex-col items-center\">\n          <feather-icon\n            icon=\"MessageSquareIcon\"\n            class=\"mb-4 bg-white p-8 shadow-md rounded-full\"\n            svgClasses=\"w-16 h-16\"\n          ></feather-icon>\n          <h4\n            class=\"py-2 px-4 bg-white shadow-md rounded-full cursor-pointer\"\n            @click.stop=\"toggleChatSidebar(true)\"\n          >\n            Start Conversation\n          </h4>\n        </div>\n      </template>\n    </div>\n  </div>\n  <div v-else>\n    <div class=\"flex flex-col items-center\">\n      conctado2: {{ getChatconnect }}\n    </div>\n    <div class=\"flex flex-col items-center\">\n      <!--TOKEN CHAT:{{getChatconnect}}-->\n\n      <feather-icon\n        icon=\"MessageSquareIcon\"\n        class=\"mb-4 bg-white p-8 shadow-md rounded-full\"\n        svgClasses=\"w-16 h-16\"\n      ></feather-icon>\n      <h4\n        class=\"py-2 px-4 bg-white shadow-md rounded-full cursor-pointer\"\n        @click.stop=\"recarga()\"\n      >\n        Start Conversation\n      </h4>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Vue from \"vue\";\nimport { mapActions } from \"vuex\";\n\nimport ChatContact from \"./ChatContact.vue\";\nimport ChatLog from \"./ChatLog.vue\";\nimport ChatNavbar from \"./ChatNavbar.vue\";\nimport UserProfile from \"./UserProfile.vue\";\nimport VuePerfectScrollbar from \"vue-perfect-scrollbar\";\nimport moduleChat from \"@/store/chat/moduleChat.js\";\nimport * as divilib from \"@/divisoftlibs/utilDivisoftJS.js\";\n\n//import io from 'socket.io-client';\nexport default {\n  created() {\n    // this.$store.commit('chat/MUTSETCURRENTCONTACT',5);\n    this.contactId = this.$route.params.contactId;\n    this.$store.commit(\"chat/MUTSETCURRENTCONTACT\", 0);\n\n    let vm = this;\n    setTimeout(function (store) {\n      vm.$store.commit(\"chat/MUTSETCURRENTCONTACT\", vm.contactId);\n    }, 2000);\n\n    let datos = {\n      NumEmpresa: this.getProfile[0].Empresa,\n      userid: this.getProfile[0].num_user,\n    };\n    // contactos\n    this.getfetContacts(datos);\n    this.getChatContacts(datos);\n    this.setSidebarWidth();\n  },\n\n  mounted() {\n    try {\n      this.$socket.connect();\n      this.$store.commit(\n        \"chat/MUTCHATCONNECT\",\n        \"No Conectado sus Mensajes No seran Entregados\"\n      );\n\n      const payload = {\n        NumEmpresa: this.getProfile[0].Empresa,\n        username: this.getProfile[0].Username,\n        id: this.getProfile[0].num_user,\n        msg: this.mensajeConectado,\n      };\n\n      this.$socket.emit(\"TEST_CONNECTION\", payload, function (response) {\n        console.log(\"se disparo el   collback de Conectado \", response);\n      });\n    } catch (error) {\n      console.log(\"en Chat.vue  en mounted catch\" + error);\n    }\n    this.typedMessage = \"\";\n  },\n\n  data() {\n    return {\n      tokenChat: \"\",\n      colorConectado: \"text-danger\",\n      mensajeConectado: \"Listo* Puede Chatear\",\n      contactId: \"0\",\n\n      chatMsg: {\n        msg: 1,\n      },\n      messages: [],\n      active: true,\n      isHidden: false,\n      searchContact: \"\",\n      activeProfileSidebar: false,\n      activeChatUser: 118,\n      userProfileId: -1,\n      typedMessage: \"\",\n      isChatPinned: false,\n      settings: {\n        maxScrollbarLength: 60,\n        wheelSpeed: 0.7,\n      },\n      clickNotClose: true,\n      isChatSidebarActive: true,\n      isLoggedInUserProfileView: false,\n    };\n  },\n  watch: {\n    getChatconnect() {\n      if (this.getChatconnect == this.mensajeConectado)\n        this.colorConectado = \"text-success\";\n    },\n    chatMsg() {\n      console.log(\"mensaje\", this.chatMsg);\n      this.setMessage(this.chatMsg);\n    },\n\n    windowWidth() {\n      this.setSidebarWidth();\n    },\n    getProfile() {\n      console.log(\"cambio el profile CHAT LINEA 167 APROX\");\n      //  alert(\"profile cambio \");\n    },\n    getCurrentContact() {\n      if (this.getCurrentContact > 0) {\n        let usuariochat = this.getCurrentContact;\n        try {\n          usuariochat = parseInt(usuariochat, 10);\n        } catch (error) {}\n\n        this.updateActiveChatUser(usuariochat);\n      }\n\n      //  alert(\"profile cambio \");\n    },\n  },\n  computed: {\n    getChatconnect() {\n      return this.$store.state.chat.chatconnect;\n    },\n    getRecargar() {\n      return this.$store.state.recargar;\n    },\n    getCurrentContact() {\n      return this.$store.state.chat.currentContact;\n    },\n\n    getAppActiveUser() {\n      return this.$store.state.AppActiveUser;\n    },\n    getchats() {\n      return this.$store.state.chat.chats;\n    },\n    getProfile() {\n      return this.$store.state.dsoaLogin.profile;\n    },\n    // COMPONENTE DIVISOFT CHAT\n    getTokenChat() {\n      return this.$store.state.dsoaLogin.token;\n    },\n\n    chatLastMessaged() {\n      return (userId) => this.$store.getters[\"chat/chatLastMessaged\"](userId);\n    },\n    chatUnseenMessages() {\n      return (userId) => {\n        const unseenMsg = this.$store.getters[\"chat/chatUnseenMessages\"](\n          userId\n        );\n        if (unseenMsg) return unseenMsg;\n      };\n    },\n    activeUser() {\n      return this.$store.state.AppActiveUser;\n    },\n    getStatusColor() {\n      return (isActiveUser) => {\n        const userStatus = this.getUserStatus(isActiveUser);\n\n        if (userStatus === \"online\") {\n          return \"success\";\n        } else if (userStatus === \"do not disturb\") {\n          return \"danger\";\n        } else if (userStatus === \"away\") {\n          return \"warning\";\n        } else {\n          return \"grey\";\n        }\n      };\n    },\n    chatContacts() {\n      return this.$store.getters[\"chat/chatContacts\"];\n    },\n    contacts() {\n      return this.$store.getters[\"chat/contacts\"];\n    },\n\n    searchQuery: {\n      get() {\n        if (this.$store.state.chat.chatSearchQuery)\n          return this.$store.state.chat.chatSearchQuery;\n        else return \"\";\n      },\n      set(val) {\n        this.$store.dispatch(\"chat/setChatSearchQuery\", val);\n      },\n    },\n    scrollbarTag() {\n      return this.$store.getters.scrollbarTag;\n    },\n    isActiveChatUser() {\n      return (userId) => userId === this.activeChatUser;\n    },\n    windowWidth() {\n      return this.$store.state.windowWidth;\n    },\n  },\n  methods: {\n    recarga() {\n      this.$router.go(this.$router.currentRoute);\n    },\n    getUserStatus(isActiveUser) {\n      // return \"active\"\n      return isActiveUser\n        ? this.$store.state.AppActiveUser.status\n        : this.contacts[this.activeChatUser].status;\n    },\n    closeProfileSidebar(value) {\n      this.activeProfileSidebar = value;\n    },\n\n    updateActiveChatUser(contactId) {\n      //  this.$store.commit('chat/MUTSETCURRENTCONTACT',5);\n      this.contactId = 0;\n\n      try {\n        this.activeChatUser = parseInt(contactId, 10);\n      } catch (error) {\n        this.activeChatUser = contactId;\n      }\n\n      let datos = {\n        NumEmpresa: this.getProfile[0].Empresa,\n        userid: this.getProfile[0].num_user,\n        userSend: contactId,\n      };\n\n      this.getfetChats(datos);\n\n      if (this.$store.getters[\"chat/chatDataOfUser\"](this.activeChatUser)) {\n        this.$store.dispatch(\"chat/markSeenAllMessages\", contactId);\n      }\n      const chatData = this.$store.getters[\"chat/chatDataOfUser\"](\n        this.activeChatUser\n      );\n      if (chatData) this.isChatPinned = chatData.isPinned;\n      else this.isChatPinned = false;\n      this.toggleChatSidebar();\n      this.typedMessage = \"\";\n    },\n    showProfileSidebar(userId, openOnLeft = false) {\n      try {\n        this.userProfileId = parseInt(userId, 10);\n      } catch (error) {\n        this.userProfileId = userId;\n      }\n\n      this.isLoggedInUserProfileView = openOnLeft;\n      this.activeProfileSidebar = !this.activeProfileSidebar;\n    },\n\n    sendMsg() {\n      //alert(\"divisoft envieando MENSAJE\");\n      if (!this.typedMessage) return;\n      if (!this.activeChatUser) return;\n\n      const payload = {\n        NumEmpresa: this.getProfile[0].Empresa,\n        isPinned: this.isChatPinned,\n        username: this.getProfile[0].Username,\n        sendusernum: this.getProfile[0].num_user,\n\n        msg: {\n          textContent: this.typedMessage,\n          time: String(new Date()),\n          isSent: true,\n          isSeen: false,\n        },\n        id: this.activeChatUser,\n      };\n      //ADEMAR VER SI HAY COMUNICACION\n      console.log(\"enviando \", JSON.stringify(payload));\n\n      this.typedMessage = \"\";\n\n      // se lo manda al destinatrio\n\n      this.$socket.emit(\"SEND_MESSAGE\", payload, function (response) {\n        console.log(\"se disparo el  collback\", response);\n      });\n      // lo refresca en nuestro chat\n\n      this.$store.dispatch(\"chat/SENDCHATMESSAGE\", payload);\n\n      const scroll_el = this.$refs.chatLogPS.$el || this.$refs.chatLogPS;\n      scroll_el.scrollTop = this.$refs.chatLog.scrollHeight;\n    },\n\n    setMessage(data) {\n      this.$store.commit(\"chat/SEND_CHAT_MESSAGE\", data);\n    },\n\n    toggleIsChatPinned(value) {\n      this.isChatPinned = value;\n    },\n    setSidebarWidth() {\n      if (this.windowWidth < 1200) {\n        this.isChatSidebarActive = this.clickNotClose = false;\n      } else {\n        this.isChatSidebarActive = this.clickNotClose = true;\n      }\n    },\n    toggleChatSidebar(value = false) {\n      if (!value && this.clickNotClose) return;\n      this.isChatSidebarActive = value;\n    },\n\n    getfetContacts(datos) {\n      this.$store.dispatch(\"chat/fetchContacts\", datos);\n      return 1;\n    },\n\n    getfetChats(datos) {\n      this.$store.dispatch(\"chat/fetchChats\", datos);\n      return 1;\n    },\n    getChatContacts(datos) {\n      this.$store.dispatch(\"chat/fetchChatContacts\", datos);\n      return 1;\n    },\n  },\n  components: {\n    VuePerfectScrollbar,\n    ChatContact,\n    UserProfile,\n    ChatNavbar,\n    ChatLog,\n  },\n\n  /* beforeDestroy() {\n         this.$store.unregisterModule('chat')\n     }*/\n};\n</script>\n\n<style lang=\"scss\">\n@import \"@/assets/scss/vuexy/apps/chat.scss\";\n</style>\n"]}]}